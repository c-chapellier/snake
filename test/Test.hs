import qualified Test.Hspec as Hspec
import qualified System.IO.Silently as Silently

import qualified Turing

main :: IO ()
main =
  Hspec.hspec $ do
    Hspec.describe "Complete outputs" $ do
      Hspec.it "can do substraction : 111-11" $ do
        (stdout, result) <- Silently.capture (Turing.turing ["app/configs/unary_sub.json", "111-11="])
        stdout `Hspec.shouldBe` "********************************************************************************\ESC[33m\nName : \ESC[0munary_sub\ESC[33m\nAlphabet: \ESC[0m[\"1\",\".\",\"-\",\"=\"]\ESC[33m\nBlank: \ESC[0m.\ESC[33m\nStates : \ESC[0m[\"scanright\",\"eraseone\",\"subone\",\"skip\",\"HALT\"]\ESC[33m\nInitial : \ESC[0mscanright\ESC[33m\nFinals : \ESC[0m[\"HALT\"]\n(\ESC[36meraseone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m=\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36meraseone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mskip\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mskip\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36msubone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36msubone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mLEFT\ESC[0m)\n********************************************************************************\n[\ESC[33m\ESC[0m\ESC[31m1\ESC[0m\ESC[33m11-11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m1-11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11\ESC[0m\ESC[31m1\ESC[0m\ESC[33m-11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m111\ESC[0m\ESC[31m-\ESC[0m\ESC[33m11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m111-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m111-1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m111-11\ESC[0m\ESC[31m=\ESC[0m\ESC[33m\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m111-1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36meraseone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m=\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m111-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36msubone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m111\ESC[0m\ESC[31m-\ESC[0m\ESC[33m1=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36msubone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11\ESC[0m\ESC[31m1\ESC[0m\ESC[33m-1=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mskip\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11.\ESC[0m\ESC[31m-\ESC[0m\ESC[33m1=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11.-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11.-1\ESC[0m\ESC[31m=\ESC[0m\ESC[33m.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11.-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36meraseone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m=\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11.\ESC[0m\ESC[31m-\ESC[0m\ESC[33m=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36msubone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11\ESC[0m\ESC[31m.\ESC[0m\ESC[33m-=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mskip\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m.-=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mskip\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1.\ESC[0m\ESC[31m.\ESC[0m\ESC[33m-=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1..\ESC[0m\ESC[31m-\ESC[0m\ESC[33m=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1..-\ESC[0m\ESC[31m=\ESC[0m\ESC[33m..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m1..\ESC[0m\ESC[31m-\ESC[0m\ESC[33m...\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36meraseone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m1.........\ESC[0m]\n"
      Hspec.it "can do substraction : 11-11" $ do
        (stdout, result) <- Silently.capture (Turing.turing ["app/configs/unary_sub.json", "11-11="])
        stdout `Hspec.shouldBe` "********************************************************************************\ESC[33m\nName : \ESC[0munary_sub\ESC[33m\nAlphabet: \ESC[0m[\"1\",\".\",\"-\",\"=\"]\ESC[33m\nBlank: \ESC[0m.\ESC[33m\nStates : \ESC[0m[\"scanright\",\"eraseone\",\"subone\",\"skip\",\"HALT\"]\ESC[33m\nInitial : \ESC[0mscanright\ESC[33m\nFinals : \ESC[0m[\"HALT\"]\n(\ESC[36meraseone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m=\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36meraseone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mskip\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mskip\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36msubone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36msubone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mLEFT\ESC[0m)\n********************************************************************************\n[\ESC[33m\ESC[0m\ESC[31m1\ESC[0m\ESC[33m1-11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m-11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11\ESC[0m\ESC[31m-\ESC[0m\ESC[33m11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11-1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11-11\ESC[0m\ESC[31m=\ESC[0m\ESC[33m\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11-1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36meraseone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m=\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36msubone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11\ESC[0m\ESC[31m-\ESC[0m\ESC[33m1=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36msubone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m-1=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mskip\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1.\ESC[0m\ESC[31m-\ESC[0m\ESC[33m1=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1.-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1.-1\ESC[0m\ESC[31m=\ESC[0m\ESC[33m.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m1.-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36meraseone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m=\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m1.\ESC[0m\ESC[31m-\ESC[0m\ESC[33m=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36msubone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m1\ESC[0m\ESC[31m.\ESC[0m\ESC[33m-=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mskip\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m\ESC[0m\ESC[31m1\ESC[0m\ESC[33m.-=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mskip\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m.\ESC[0m\ESC[31m.\ESC[0m\ESC[33m-=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m..\ESC[0m\ESC[31m-\ESC[0m\ESC[33m=..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m..-\ESC[0m\ESC[31m=\ESC[0m\ESC[33m..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m..\ESC[0m\ESC[31m-\ESC[0m\ESC[33m...\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36meraseone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m.........\ESC[0m]\n"
      Hspec.it "can do substraction : 111-1" $ do
        (stdout, result) <- Silently.capture (Turing.turing ["app/configs/unary_sub.json", "111-1="])
        stdout `Hspec.shouldBe` "********************************************************************************\ESC[33m\nName : \ESC[0munary_sub\ESC[33m\nAlphabet: \ESC[0m[\"1\",\".\",\"-\",\"=\"]\ESC[33m\nBlank: \ESC[0m.\ESC[33m\nStates : \ESC[0m[\"scanright\",\"eraseone\",\"subone\",\"skip\",\"HALT\"]\ESC[33m\nInitial : \ESC[0mscanright\ESC[33m\nFinals : \ESC[0m[\"HALT\"]\n(\ESC[36meraseone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m=\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36meraseone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mskip\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mskip\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36msubone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36msubone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mLEFT\ESC[0m)\n********************************************************************************\n[\ESC[33m\ESC[0m\ESC[31m1\ESC[0m\ESC[33m11-1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m1-1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11\ESC[0m\ESC[31m1\ESC[0m\ESC[33m-1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m111\ESC[0m\ESC[31m-\ESC[0m\ESC[33m1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m111-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m111-1\ESC[0m\ESC[31m=\ESC[0m\ESC[33m\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m111-\ESC[0m\ESC[31m1\ESC[0m\ESC[33m.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36meraseone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34msubone\ESC[0m, \ESC[35m=\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m111\ESC[0m\ESC[31m-\ESC[0m\ESC[33m=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36msubone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mskip\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11\ESC[0m\ESC[31m1\ESC[0m\ESC[33m-=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mskip\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11.\ESC[0m\ESC[31m-\ESC[0m\ESC[33m=.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m-\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11.-\ESC[0m\ESC[31m=\ESC[0m\ESC[33m.\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34meraseone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11.\ESC[0m\ESC[31m-\ESC[0m\ESC[33m..\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36meraseone\ESC[0m, \ESC[31m-\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11.......\ESC[0m]\n"
      Hspec.it "can do addition : 111+11" $ do
        (stdout, result) <- Silently.capture (Turing.turing ["app/configs/unary_add.json", "111+11="])
        stdout `Hspec.shouldBe` "********************************************************************************\ESC[33m\nName : \ESC[0munary_add\ESC[33m\nAlphabet: \ESC[0m[\"1\",\".\",\"+\",\"=\"]\ESC[33m\nBlank: \ESC[0m.\ESC[33m\nStates : \ESC[0m[\"scanright\",\"addone\",\"HALT\"]\ESC[33m\nInitial : \ESC[0mscanright\ESC[33m\nFinals : \ESC[0m[\"HALT\"]\n(\ESC[36maddone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m+\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36maddone\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36maddone\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m+\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n********************************************************************************\n[\ESC[33m\ESC[0m\ESC[31m1\ESC[0m\ESC[33m11+11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1\ESC[0m\ESC[31m1\ESC[0m\ESC[33m1+11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11\ESC[0m\ESC[31m1\ESC[0m\ESC[33m+11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m111\ESC[0m\ESC[31m+\ESC[0m\ESC[33m11=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m+\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m111.\ESC[0m\ESC[31m1\ESC[0m\ESC[33m1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36maddone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m+\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m111\ESC[0m\ESC[31m.\ESC[0m\ESC[33m+1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36maddone\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1111\ESC[0m\ESC[31m+\ESC[0m\ESC[33m1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m+\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1111.\ESC[0m\ESC[31m1\ESC[0m\ESC[33m=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36maddone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m+\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m1111\ESC[0m\ESC[31m.\ESC[0m\ESC[33m+=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36maddone\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11111\ESC[0m\ESC[31m+\ESC[0m\ESC[33m=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m+\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11111.\ESC[0m\ESC[31m=\ESC[0m\ESC[33m\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36maddone\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11111.....\ESC[0m]\n"
      Hspec.it "can do addition : 1+1" $ do
        (stdout, result) <- Silently.capture (Turing.turing ["app/configs/unary_add.json", "1+1="])
        stdout `Hspec.shouldBe` "********************************************************************************\ESC[33m\nName : \ESC[0munary_add\ESC[33m\nAlphabet: \ESC[0m[\"1\",\".\",\"+\",\"=\"]\ESC[33m\nBlank: \ESC[0m.\ESC[33m\nStates : \ESC[0m[\"scanright\",\"addone\",\"HALT\"]\ESC[33m\nInitial : \ESC[0mscanright\ESC[33m\nFinals : \ESC[0m[\"HALT\"]\n(\ESC[36maddone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m+\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36maddone\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36maddone\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n(\ESC[36mscanright\ESC[0m, \ESC[31m+\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n********************************************************************************\n[\ESC[33m\ESC[0m\ESC[31m1\ESC[0m\ESC[33m+1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1\ESC[0m\ESC[31m+\ESC[0m\ESC[33m1=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m+\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m1.\ESC[0m\ESC[31m1\ESC[0m\ESC[33m=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36maddone\ESC[0m, \ESC[31m1\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m+\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m1\ESC[0m\ESC[31m.\ESC[0m\ESC[33m+=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36maddone\ESC[0m, \ESC[31m.\ESC[0m) -> (\ESC[34mscanright\ESC[0m, \ESC[35m1\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11\ESC[0m\ESC[31m+\ESC[0m\ESC[33m=\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36mscanright\ESC[0m, \ESC[31m+\ESC[0m) -> (\ESC[34maddone\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mRIGHT\ESC[0m)\n[\ESC[33m11.\ESC[0m\ESC[31m=\ESC[0m\ESC[33m\ESC[0m\ESC[33m...\ESC[0m] (\ESC[36maddone\ESC[0m, \ESC[31m=\ESC[0m) -> (\ESC[34mHALT\ESC[0m, \ESC[35m.\ESC[0m, \ESC[32mLEFT\ESC[0m)\n[\ESC[33m11.....\ESC[0m]\n"
